<!DOCTYPE HTML>
<html>
	<head>	
		<title>webcheck</title>
		<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">	
		
		<link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', filename='css/flat-ui.css') }}">	
	</head>
	
	<body>		
	
	<div class="container">
		
		<div class="demo-headline">
			<h1>webcheck</h1>
			<a href="#" />logout</a>
		</div>

		<div class="row">
			<div class="span3">
				<b>Add website</b>
				<form name="addsite" method="POST">
					<input id="input-url" type="text" name="url" placeholder="url"><a id="addlink" href="#" class="btn btn-large btn-primary">Add site</a>
				</form>
			</div>
			
			<div class="span8 offset">
					<ul class=entries>
					{% for site in sites %}
					<div class="site-entry">
						<b><a href="{{ site.url }}" target="_blank">{{ site.url }}</a></b>
						<br />
						<div class="details">
							<div class="left">
								<b>Last check:</b> 
								<br />
								{{ site.last_check }}
							</div>						
							<div class="right">
								 {{ site.status_code }} 
								 <a id="edit-site{{ site.id }}" href="#" class="btn btn-mini btn-warning">Edit</a> 
								 <a id="delete-site{{ site.id }}" href="#" class="btn btn-small btn-danger">Delete</a>
							</div>	
						</div>
					</div>
					<br />
					{% else %}
					<em>No sites so far...</em>
					{% endfor %}
					</ul>
			</div>			
		</div>
		
	</div>
	
	<footer>
		<div class="container">
			<div class="row">
			<h3 class="footer-title">ver 0.1</h3>
			</div>
		</div>
	<footer>	
	
	<script src="{{ url_for('static', filename='js/jquery-1.10.2.min.js') }}"></script>
	<script type="text/javascript">
		$(document).ready(function(){
			$('#addlink').click(function() {
				var url = document.getElementById('input-url').value;

				$.ajax({
					type: "POST",
					contentType: "application/json; charset=utf-8",
					url: "/add",
					data: JSON.stringify({ url: url }),
					success: function(data) {
						console.log(data);
					},
					dataType: "json"
				});
			});
			
			$('.btn-danger').click(function(e) {
				var id = e.target.id.replace("delete-site", "");

				$.ajax({
					type: "DELETE",
					url: "/delete/" + id,	
					success: function()	{
						console.log("ok");
					},	
				});
			});
			
		});
	</script>
	</body>
	
</html>
